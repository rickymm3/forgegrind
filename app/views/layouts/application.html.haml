!!!
%html
  %head
    %meta{content: "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}/
    %title= content_for(:title) || "Forgegrind"
    %meta{content: "width=device-width,initial-scale=1", name: "viewport"}/
    %meta{content: "yes", name: "apple-mobile-web-app-capable"}/
    %meta{content: "yes", name: "mobile-web-app-capable"}/
    = csrf_meta_tags
    = csp_meta_tag
    = yield :head
    %link{href: "/icon.png", rel: "icon", type: "image/png"}/
    %link{href: "/icon.svg", rel: "icon", type: "image/svg+xml"}/
    %link{href: "/icon.png", rel: "apple-touch-icon"}/
    = stylesheet_link_tag :app, "data-turbo-track": "reload"
    = stylesheet_link_tag "tailwind", "data-turbo-track": "reload"
    = javascript_include_tag "application", "data-turbo-track": "reload", type: "module"

  %body.bg-slate-950.text-slate-100.flex.flex-col.min-h-screen
    %div#toast-container{ class: "fixed top-4 left-4 z-[120] flex flex-col items-start gap-2 w-full max-w-sm" }
    - has_flash_messages = flash.any?
    - has_header_content = content_for?(:header)
    - show_admin_nav = admin_namespace?
    - header_classes = ["app-shell__header"]
    - header_classes << "hidden" unless has_flash_messages || has_header_content || show_admin_nav
    .app-shell
      %header{ class: header_classes.join(' ') }
        - inner_classes = ["app-shell__header-inner"]
        - inner_classes << "app-shell__header-inner--spaced" if has_flash_messages || has_header_content || show_admin_nav
        %div{ class: inner_classes.join(' ') }
          = render "shared/flash_messages", flash_messages: flash
          - if show_admin_nav
            = render "admin/shared/nav", nav_items: admin_nav_items
          - if has_header_content
            = yield :header

      - main_classes = content_for?(:main_classes_override) ? Array(content_for(:main_classes_override)) : ["app-shell__main"]
      - main_classes.concat(Array(content_for(:main_class))) if content_for?(:main_class)
      - main_style = content_for?(:main_style) ? content_for(:main_style) : nil
      %main{ class: main_classes.compact.join(' '), style: main_style }
        - inner_classes = content_for?(:main_inner_classes_override) ? Array(content_for(:main_inner_classes_override)) : ["app-shell__main-inner"]
        - inner_classes.concat(Array(content_for(:main_inner_class))) if content_for?(:main_inner_class)
        %div{ class: inner_classes.compact.join(' ') }
          = yield
      - unless admin_namespace?
        %footer.app-shell__tabbar{ data: { controller: "tabbar", tabbar_state_value: "visible" } }
          %button.tabbar-toggle{ type: "button",
                                 aria: { pressed: "false", label: "Hide navigation" },
                                 data: { action: "tabbar#toggle", tabbar_target: "toggle" } }
            %span{ data: { tabbar_target: "icon" } } â†“
          .tabbar-panel{ data: { tabbar_target: "panel" }, aria: { hidden: "false" } }
            = render partial: "shared/nav/tabbar", locals: { dom_id: "primary-tabbar" }
