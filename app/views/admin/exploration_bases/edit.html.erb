<div class="admin-header">
  <h1>Edit World Base</h1>
  <p class="admin-header__subtitle">
    Adjust settings for <code><%= @entry.key %></code>. Changes are written to <code>config/explorations/bases.yml</code>.
  </p>
</div>

<div class="admin-card">
  <%= form_with url: admin_exploration_basis_path(@entry.key), method: :put, class: "admin-form" do |f| %>
    <% data = @entry.data.with_indifferent_access %>
    <div class="form-field">
      <%= f.label :label, class: "form-label" %>
      <%= f.text_field :label, value: data[:label], class: "form-input" %>
    </div>

    <div class="form-grid">
      <div class="form-field">
        <%= f.label :world_name, class: "form-label" %>
        <%= f.text_field :world_name, value: data[:world_name], class: "form-input" %>
      </div>
      <div class="form-field">
        <%= f.label :world_key, class: "form-label" %>
        <%= f.text_field :world_key, value: data[:world_key], class: "form-input" %>
      </div>
    </div>

    <div class="form-grid">
      <div class="form-field">
        <%= f.label :tier, class: "form-label" %>
        <%= f.number_field :tier, value: data[:tier], class: "form-input", min: 1 %>
      </div>
      <div class="form-field">
        <%= f.label :player_level_min, "Player Level Min", class: "form-label" %>
        <%= f.number_field :player_level_min, value: data[:player_level_min], class: "form-input", min: 1 %>
      </div>
      <div class="form-field">
        <%= f.label :default_duration, "Default Duration (minutes)", class: "form-label" %>
        <%= f.number_field :default_duration, value: data[:default_duration], class: "form-input", min: 1 %>
      </div>
    </div>

    <div class="form-field">
      <%= f.label :flavor, class: "form-label" %>
      <%= f.text_area :flavor, value: data[:flavor], class: "form-textarea", rows: 2 %>
    </div>

    <div class="form-grid">
      <div class="form-field">
        <%= f.label :world_tags_text, "World Tags (one per line)", class: "form-label" %>
        <%= f.text_area :world_tags_text, value: Array(data[:world_tags]).join("\n"), class: "form-textarea", rows: 3 %>
      </div>
      <div class="form-field">
        <%= f.label :checkpoint_labels_text, "Checkpoint Labels (one per line)", class: "form-label" %>
        <%= f.text_area :checkpoint_labels_text, value: Array(data[:checkpoint_labels]).join("\n"), class: "form-textarea", rows: 3 %>
      </div>
    </div>

    <div class="form-field">
      <%= f.label :requirements_yaml, "Requirements (YAML)", class: "form-label" %>
      <%= f.text_area :requirements_yaml, value: (data[:requirements].presence && data[:requirements].to_yaml), class: "form-textarea font-mono", rows: 6 %>
    </div>

    <div class="form-field">
      <%= f.label :rewards_yaml, "Rewards (YAML)", class: "form-label" %>
      <%= f.text_area :rewards_yaml, value: (data[:rewards].presence && data[:rewards].to_yaml), class: "form-textarea font-mono", rows: 6 %>
    </div>

    <div class="form-actions">
      <%= link_to "Cancel", admin_exploration_bases_path, class: "btn btn--secondary" %>
      <%= f.submit "Save World", class: "btn btn--primary" %>
    </div>
  <% end %>
</div>
