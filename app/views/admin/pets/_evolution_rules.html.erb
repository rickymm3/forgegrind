<section class="mt-10 space-y-6">
  <div>
    <h2 class="text-2xl font-semibold text-slate-900">Evolution Paths</h2>
    <p class="text-sm text-slate-500">Manage how <%= pet.name %> transforms once its requirements are met.</p>
  </div>

  <% if evolution_rules.any? %>
    <div class="space-y-4">
      <% evolution_rules.each do |rule| %>
        <div class="rounded-3xl border border-slate-200 bg-white p-5 flex flex-col gap-3">
          <div class="flex items-center justify-between">
            <div>
              <p class="text-sm font-semibold text-slate-900">
                Evolves into
                <%= link_to rule.child_pet.name, edit_admin_evolution_rule_path(rule), class: "text-indigo-600 hover:text-indigo-500" %>
              </p>
              <p class="text-xs text-slate-500">
                Level trigger: <%= rule.trigger_level || "—" %> • Priority: <%= rule.priority || 0 %>
              </p>
            </div>
            <div class="flex items-center gap-2 text-xs font-semibold">
              <%= link_to "Edit", edit_admin_evolution_rule_path(rule), class: "rounded-full border border-slate-300 px-3 py-1 text-slate-600 hover:border-indigo-400 hover:text-indigo-500" %>
              <%= button_to "Delete", admin_evolution_rule_path(rule), method: :delete, data: { turbo_confirm: "Delete this evolution?" }, class: "rounded-full bg-rose-50 px-3 py-1 text-rose-600" %>
            </div>
          </div>

          <div class="grid gap-3 md:grid-cols-2 text-sm text-slate-700">
            <div>
              <p><span class="font-semibold">Success Chance:</span> <%= rule.success_chance_percent || 100 %>%</p>
              <% if rule.fallback_child_pet %>
                <p><span class="font-semibold">Fallback:</span> <%= rule.fallback_child_pet.name %></p>
              <% end %>
              <% if rule.required_item %>
                <p><span class="font-semibold">Required Item:</span> <%= rule.required_item.name %></p>
              <% end %>
            </div>
            <div>
              <% if rule.required_badges.present? %>
                <p class="font-semibold text-xs uppercase text-slate-500 mb-1">Badges</p>
                <div class="flex flex-wrap gap-2">
                  <% rule.required_badges.each do |badge_key| %>
                    <span class="inline-flex items-center rounded-full bg-slate-100 px-2 py-1 text-xs font-semibold text-slate-700"><%= badge_key %></span>
                  <% end %>
                </div>
              <% else %>
                <p class="text-xs text-slate-400">No badge requirement.</p>
              <% end %>
            </div>
          </div>
        </div>
      <% end %>
    </div>
  <% else %>
    <p class="text-sm text-slate-500">No evolution paths defined yet for this pet.</p>
  <% end %>

  <div class="flex items-center justify-end">
    <%= link_to "Add Evolution", new_admin_evolution_rule_path(parent_pet_id: pet.id), class: "inline-flex items-center rounded-full bg-indigo-600 px-4 py-2 text-sm font-semibold text-white hover:bg-indigo-500" %>
  </div>
</section>
