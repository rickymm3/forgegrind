- generated = @user_exploration.generated_exploration
- progress = generated&.requirements_progress_for(@user_exploration.user_pets) || []
- detail_dom_id = generated ? dom_id(generated, :detail) : dom_id(@user_exploration.world, :detail)
- list_dom_id = generated ? dom_id(generated, :card) : nil

= turbo_stream.update detail_dom_id do
  = render "explorations/zone_card",
           generated_exploration: generated || GeneratedExploration.new(world: @user_exploration.world, name: @user_exploration.world.name, duration_seconds: @user_exploration.duration_seconds, requirements: []),
           user_exploration: @user_exploration,
           state: :ready,
           requirement_progress: progress,
           requirement_groups: progress.group_by { |entry| entry[:source] || 'base' },
           available_pets: [],
           selected_pet_ids: [],
           filters: {},
           show_filters: false,
           compact_layout: true

- if list_dom_id
  = turbo_stream.update list_dom_id do
    = render "explorations/world_tile",
             slot_index: generated&.slot_index,
             generated_exploration: generated,
             requirement_progress: progress,
             requirement_groups: progress.group_by { |entry| entry[:source] || 'base' },
             selected: true,
             state: :ready,
             user_exploration: @user_exploration,
             cooldown_seconds: generated&.cooldown_remaining_seconds || 0,
             cooldown_ends_at: generated&.cooldown_ends_at,
             reroll_cooldown_seconds: generated&.reroll_cooldown_remaining_seconds || 0,
             reroll_available_at: generated&.reroll_available_at
