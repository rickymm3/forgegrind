!!!
%html
  %head
    %meta{content: "text/html; charset=UTF-8", "http-equiv" => "Content-Type"}/
    %title= content_for(:title) || "Forgegrind"
    %meta{content: "width=device-width,initial-scale=1", name: "viewport"}/
    %meta{content: "yes", name: "apple-mobile-web-app-capable"}/
    %meta{content: "yes", name: "mobile-web-app-capable"}/
    = csrf_meta_tags
    = csp_meta_tag
    = yield :head
    %link{href: "/icon.png", rel: "icon", type: "image/png"}/
    %link{href: "/icon.svg", rel: "icon", type: "image/svg+xml"}/
    %link{href: "/icon.png", rel: "apple-touch-icon"}/
    = stylesheet_link_tag :app, "data-turbo-track": "reload"
    = stylesheet_link_tag "tailwind", "data-turbo-track": "reload"
    = javascript_include_tag "application", "data-turbo-track": "reload", type: "module"

  %body.bg-slate-950.text-slate-100.flex.flex-col.min-h-screen
    - has_flash_messages = flash.any?
    - has_header_content = content_for?(:header)
    - header_classes = ["sticky top-0 z-50 w-full border-b border-slate-800 bg-slate-950/95 backdrop-blur"]
    - header_classes << "hidden" unless has_flash_messages || has_header_content
    %header{ class: header_classes.join(' ') }
      - inner_classes = ["mx-auto flex w-full max-w-4xl flex-col gap-2 px-4"]
      - inner_classes << "py-4" if has_flash_messages || has_header_content
      %div{ class: inner_classes.join(' ') }
        = render "shared/flash_messages", flash_messages: flash
        - if has_header_content
          = yield :header
    - main_classes = ["flex-1", "w-full", "px-4", "pt-6"]
    - main_classes.concat(Array(content_for(:main_class))) if content_for?(:main_class)
    - main_style = content_for?(:main_style) ? content_for(:main_style) : "padding-bottom: calc(env(safe-area-inset-bottom, 0px) + 7rem);"
    %main{ class: (main_classes << "pb-[112px]").join(' '), style: main_style }
      .mx-auto.w-full.max-w-4xl{ class: (content_for?(:main_inner_class) ? content_for(:main_inner_class) : nil) }
        = yield
    = render partial: "shared/nav/tabbar", locals: { dom_id: "primary-tabbar" }
